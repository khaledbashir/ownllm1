/* ============================================================
   NUCLEAR SLASH COMMAND MENU FIX
   This file uses extremely aggressive selectors to ensure
   the BlockNote slash menu is ALWAYS visible and styled.
   ============================================================ */

/* STEP 1: Target EVERY possible portal/dropdown/menu container */
div[data-floating-ui-portal],
div[data-radix-popper-content-wrapper],
div[data-radix-portal],
.mantine-Portal,
[class*="portal"],
[class*="Portal"] {
    position: fixed !important;
    z-index: 999999 !important;
}

/* STEP 2: The actual menu container - be extremely aggressive */
div[data-floating-ui-portal]>div,
div[data-radix-popper-content-wrapper]>div,
.bn-suggestion-menu,
[data-bn-suggestion-menu],
.mantine-Menu-dropdown,
.mantine-Popover-dropdown,
[class*="suggestionMenu"],
[class*="SuggestionMenu"],
[class*="slashMenu"],
[class*="SlashMenu"],
[role="menu"],
[role="listbox"] {
    /* FORCE VISIBILITY */
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    pointer-events: auto !important;

    /* FORCE SIZE - MINIMUM 320px wide */
    min-width: 320px !important;
    width: auto !important;
    max-width: 400px !important;
    min-height: 100px !important;
    max-height: 400px !important;

    /* FORCE POSITION */
    position: fixed !important;
    z-index: 999999 !important;

    /* FORCE STYLING */
    background: #1a1b26 !important;
    border: 1px solid #414868 !important;
    border-radius: 12px !important;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 255, 255, 0.05) !important;
    padding: 8px !important;

    /* FORCE SCROLL */
    overflow-y: auto !important;
    overflow-x: hidden !important;

    /* KILL any transforms that might break positioning */
    transform: none !important;
}

/* STEP 3: Menu items - make them BIG and CLICKABLE */
[data-bn-menu-item],
.bn-menu-item,
[role="menuitem"],
[role="option"],
.mantine-Menu-item,
[class*="menuItem"],
[class*="MenuItem"],
div[data-floating-ui-portal] [class*="item"],
div[data-floating-ui-portal] button,
.bn-suggestion-menu>div>div,
[data-bn-suggestion-menu]>div>div {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;

    /* MAKE ITEMS BIG */
    padding: 12px 16px !important;
    margin: 2px 0 !important;
    min-height: 44px !important;
    width: 100% !important;

    /* STYLING */
    background: transparent !important;
    border: none !important;
    border-radius: 8px !important;
    cursor: pointer !important;

    /* TEXT */
    color: #c0caf5 !important;
    font-size: 14px !important;
    font-weight: 500 !important;
    text-align: left !important;

    /* TRANSITION */
    transition: background 0.15s ease !important;
}

/* STEP 4: Hover states */
[data-bn-menu-item]:hover,
.bn-menu-item:hover,
[role="menuitem"]:hover,
[role="option"]:hover,
.mantine-Menu-item:hover,
[class*="menuItem"]:hover,
[class*="MenuItem"]:hover,
div[data-floating-ui-portal] [class*="item"]:hover,
div[data-floating-ui-portal] button:hover {
    background: #24283b !important;
}

/* STEP 5: Selected/Active states */
[data-bn-menu-item][data-selected="true"],
[data-bn-menu-item][aria-selected="true"],
[data-bn-menu-item][data-hovered="true"],
.bn-menu-item[data-selected="true"],
.bn-menu-item[aria-selected="true"],
[role="option"][aria-selected="true"],
[class*="selected"],
[class*="active"],
[class*="hovered"] {
    background: #364a82 !important;
    color: #ffffff !important;
}

/* STEP 6: Icons in menu items */
[data-bn-menu-item] svg,
.bn-menu-item svg,
[role="menuitem"] svg,
div[data-floating-ui-portal] [class*="item"] svg,
[class*="menuItem"] svg,
[class*="icon"] {
    width: 20px !important;
    height: 20px !important;
    flex-shrink: 0 !important;
    color: #7aa2f7 !important;
}

/* STEP 7: Text inside items */
[data-bn-menu-item] span,
.bn-menu-item span,
.bn-menu-item-title,
.bn-menu-item-name,
[class*="title"],
[class*="name"],
[class*="label"] {
    color: #c0caf5 !important;
    font-size: 14px !important;
    font-weight: 500 !important;
}

/* Subtitle/hint text */
.bn-menu-item-subtitle,
.bn-menu-item-hint,
[class*="subtitle"],
[class*="hint"],
[class*="description"] {
    color: #565f89 !important;
    font-size: 12px !important;
    font-weight: 400 !important;
}

/* STEP 8: Group headers in menu */
[class*="group-label"],
[class*="groupLabel"],
[class*="GroupLabel"],
.bn-menu-group-title {
    color: #7aa2f7 !important;
    font-size: 11px !important;
    font-weight: 600 !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    padding: 8px 16px 4px !important;
    margin-top: 8px !important;
}

/* STEP 9: Scrollbar styling */
div[data-floating-ui-portal]>div::-webkit-scrollbar,
.bn-suggestion-menu::-webkit-scrollbar {
    width: 6px !important;
}

div[data-floating-ui-portal]>div::-webkit-scrollbar-track,
.bn-suggestion-menu::-webkit-scrollbar-track {
    background: transparent !important;
}

div[data-floating-ui-portal]>div::-webkit-scrollbar-thumb,
.bn-suggestion-menu::-webkit-scrollbar-thumb {
    background: #414868 !important;
    border-radius: 3px !important;
}

/* ============================================================
   EDITOR HEIGHT FIX
   ============================================================ */

/* Force full height on all containers */
.blocknote-dark-wrapper,
.blocknote-editor-full,
.bn-container,
.bn-editor {
    display: flex !important;
    flex-direction: column !important;
    flex: 1 1 auto !important;
    min-height: 100% !important;
    height: 100% !important;
}

/* The actual editable area */
.ProseMirror {
    flex: 1 1 auto !important;
    min-height: 100% !important;
    height: auto !important;
    padding: 24px !important;
    outline: none !important;
    cursor: text !important;
}

/* Click anywhere to focus */
.bn-editor,
.bn-container {
    cursor: text !important;
}

/* Ensure wrapper scrolls */
.blocknote-dark-wrapper {
    overflow-y: auto !important;
    overflow-x: hidden !important;
}

/* ============================================================
   EMOJI PICKER FIX
   ============================================================ */

.bn-emoji-picker,
[data-bn-type="emoji-picker"],
[class*="emoji-picker"],
[class*="emojiPicker"] {
    min-width: 320px !important;
    min-height: 350px !important;
    max-height: 400px !important;
    background: #1a1b26 !important;
    border: 1px solid #414868 !important;
    border-radius: 12px !important;
    z-index: 999999 !important;
}

/* ============================================================
   PREVENT PARENT CLIPPING
   ============================================================ */

.rich-editor-container,
.thread-notes-container,
[class*="thread"],
[class*="notes"],
[class*="editor-container"] {
    overflow: visible !important;
}