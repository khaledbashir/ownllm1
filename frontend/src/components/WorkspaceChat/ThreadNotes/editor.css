/* =========================================================
   BLOCKSUITE DARK THEME - OPERATION BLACKOUT
   Complete dark mode fix using official Affine CSS variables
   ========================================================= */

/* 
 * The container has data-theme="dark" which tells BlockSuite
 * to use dark mode. But we also need to ensure any rogue
 * elements respect our dark background.
 */

/* Force dark background on all BlockSuite containers */
.blocksuite-editor-wrapper,
.blocksuite-editor-wrapper affine-editor-container,
.blocksuite-editor-wrapper [data-block-is-root],
.blocksuite-editor-wrapper .affine-page-root,
.blocksuite-editor-wrapper .affine-page-viewport,
.blocksuite-editor-wrapper .affine-doc-viewport,
.blocksuite-editor-wrapper .affine-default-page-block-container,
.blocksuite-editor-wrapper .affine-surface-container {
  background: var(--affine-background-primary-color, #141414) !important;
  background-color: var(--affine-background-primary-color, #141414) !important;
}

/* Note block container */
.blocksuite-editor-wrapper .affine-note-block-container {
  background: var(--affine-background-primary-color, #141414) !important;
}

/* Ensure text is always light */
.blocksuite-editor-wrapper,
.blocksuite-editor-wrapper * {
  color: var(--affine-text-primary-color, #eaeaea);
}

.blocksuite-editor-wrapper [contenteditable="true"] {
  caret-color: var(--affine-text-primary-color, #eaeaea) !important;
}

/* Placeholder text */
.blocksuite-editor-wrapper [data-placeholder]::before,
.blocksuite-editor-wrapper .placeholder,
.blocksuite-editor-wrapper [placeholder]::before {
  color: var(--affine-placeholder-color, #3e3e3f) !important;
  opacity: 1 !important;
}

/* Selection highlight */
.blocksuite-editor-wrapper ::selection {
  background: rgba(30, 150, 235, 0.3) !important;
}

/* Borders */
.blocksuite-editor-wrapper hr,
.blocksuite-editor-wrapper .affine-divider,
.blocksuite-editor-wrapper .divider {
  border-color: var(--affine-border-color, #2e2e2e) !important;
  background-color: var(--affine-divider-color, #727272) !important;
}

/* Tables */
.blocksuite-editor-wrapper table,
.blocksuite-editor-wrapper td,
.blocksuite-editor-wrapper th {
  border-color: var(--affine-border-color, #2e2e2e) !important;
}

.blocksuite-editor-wrapper td,
.blocksuite-editor-wrapper th {
  background-color: var(--affine-background-secondary-color, #252525) !important;
}

/* Code blocks */
.blocksuite-editor-wrapper pre,
.blocksuite-editor-wrapper code,
.blocksuite-editor-wrapper .affine-code-block {
  background-color: var(--affine-background-code-block, #1f2022) !important;
  color: var(--affine-text-primary-color, #eaeaea) !important;
}

/* Blockquotes */
.blocksuite-editor-wrapper blockquote,
.blocksuite-editor-wrapper .affine-quote {
  border-left-color: var(--affine-quote-color, #8e8d91) !important;
  color: var(--affine-quote-color, #8e8d91) !important;
}

/* Links */
.blocksuite-editor-wrapper a {
  color: var(--affine-link-color, #78BEFF) !important;
}

/* Menus and popups - ensure they inherit dark mode */
.affine-slash-menu,
.affine-menu-container,
.affine-format-bar-widget,
.affine-toolbar,
.blocksuite-overlay {
  background-color: var(--affine-background-overlay-panel-color, #1e1e1e) !important;
  border-color: var(--affine-border-color, #2e2e2e) !important;
  box-shadow: var(--affine-menu-shadow) !important;
}

/* Menu items */
.affine-slash-menu-item,
.affine-menu-button,
.affine-menu-action,
.affine-toolbar-button {
  color: var(--affine-text-primary-color, #eaeaea) !important;
}

.affine-slash-menu-item:hover,
.affine-menu-button:hover,
.affine-menu-action:hover,
.affine-toolbar-button:hover {
  background-color: var(--affine-hover-color-filled, #2a2a2a) !important;
}

/* Database/Kanban views */
.blocksuite-editor-wrapper .affine-database-title,
.blocksuite-editor-wrapper .affine-kanban,
.blocksuite-editor-wrapper .affine-database {
  background-color: var(--affine-background-secondary-color, #252525) !important;
}

.blocksuite-editor-wrapper .affine-database-block-tag {
  background-color: var(--affine-tag-gray, #292929) !important;
}

/* Doc title */
.blocksuite-editor-wrapper .doc-title-container,
.blocksuite-editor-wrapper .doc-title {
  background: transparent !important;
  color: var(--affine-text-primary-color, #eaeaea) !important;
}

/* Icons */
.blocksuite-editor-wrapper svg {
  color: var(--affine-icon-color, #a8a8a0) !important;
  fill: currentColor;
}

/* Scrollbar - dark themed */
.blocksuite-editor-wrapper::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

.blocksuite-editor-wrapper::-webkit-scrollbar-track {
  background: var(--affine-background-primary-color, #141414);
}

.blocksuite-editor-wrapper::-webkit-scrollbar-thumb {
  background: var(--affine-border-color, #2e2e2e);
  border-radius: 4px;
}

.blocksuite-editor-wrapper::-webkit-scrollbar-thumb:hover {
  background: var(--affine-hover-color-filled, #2a2a2a);
}

/* Tags */
.blocksuite-editor-wrapper .affine-tag-blue {
  background-color: rgba(8, 67, 136, 1) !important;
}

.blocksuite-editor-wrapper .affine-tag-green {
  background-color: rgba(44, 108, 63, 1) !important;
}

.blocksuite-editor-wrapper .affine-tag-teal {
  background-color: rgba(26, 115, 110, 1) !important;
}

.blocksuite-editor-wrapper .affine-tag-purple {
  background-color: rgba(47, 30, 113, 1) !important;
}

.blocksuite-editor-wrapper .affine-tag-red {
  background-color: rgba(111, 50, 50, 1) !important;
}

.blocksuite-editor-wrapper .affine-tag-yellow {
  background-color: rgba(150, 132, 49, 1) !important;
}

.blocksuite-editor-wrapper .affine-tag-orange {
  background-color: rgba(185, 129, 46, 1) !important;
}

.blocksuite-editor-wrapper .affine-tag-gray {
  background-color: rgba(41, 41, 41, 1) !important;
}

/* Ensure no white flash on load */
.blocksuite-editor-wrapper {
  background: #141414 !important;
}

/* =========================================================
   GLOBAL PORTAL OVERRIDES - These render at body level
   Slash menus, modals, dialogs, etc.
   ========================================================= */

/* Force data-theme on body for BlockSuite portals */
body {
  --affine-theme-mode: dark;
  --affine-background-primary-color: #141414;
  --affine-background-secondary-color: #252525;
  --affine-background-tertiary-color: #303030;
  --affine-background-overlay-panel-color: #1e1e1e;
  --affine-text-primary-color: #eaeaea;
  --affine-text-secondary-color: #9c9ca0;
  --affine-border-color: #2e2e2e;
  --affine-divider-color: #727272;
  --affine-placeholder-color: #3e3e3f;
  --affine-hover-color: rgba(255, 255, 255, 0.1);
  --affine-hover-color-filled: #2a2a2a;
  --affine-link-color: #78BEFF;
  --affine-icon-color: #a8a8a0;
  --affine-white: #000;
  --affine-black: #fff;
}

/* ALL Affine/BlockSuite popups, menus, overlays */
[class*="affine-"][class*="-menu"],
[class*="affine-"][class*="-popup"],
[class*="affine-"][class*="-modal"],
[class*="affine-"][class*="-dialog"],
[class*="affine-"][class*="-overlay"],
[class*="affine-"][class*="-panel"],
[class*="affine-"][class*="-toolbar"],
[class*="affine-"][class*="-tooltip"],
.affine-menu-container,
.affine-slash-menu,
.affine-linked-doc-popover,
.affine-reference-popover,
.affine-embed-card-toolbar,
.affine-toolbar-widget,
.blocksuite-portal,
.blocksuite-overlay,
affine-portal,
affine-overlay-root {
  background-color: #1e1e1e !important;
  background: #1e1e1e !important;
  border-color: #2e2e2e !important;
  color: #eaeaea !important;
}

/* Modal dialogs (like Link input) */
.affine-modal,
.affine-modal-container,
.affine-dialog,
.affine-link-popover,
.affine-embed-link-input,
.affine-confirm-modal,
[role="dialog"],
[role="alertdialog"] {
  background-color: #1e1e1e !important;
  background: #1e1e1e !important;
  border-color: #2e2e2e !important;
  color: #eaeaea !important;
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.6) !important;
}

/* Modal backdrop */
.affine-modal-backdrop,
.affine-overlay-mask,
.modal-overlay {
  background-color: rgba(0, 0, 0, 0.7) !important;
}

/* Modal content areas */
.affine-modal *,
.affine-dialog *,
[role="dialog"] *,
.affine-link-popover *,
.affine-embed-card-modal * {
  color: #eaeaea !important;
}

/* Modal headers */
.affine-modal h1,
.affine-modal h2,
.affine-modal h3,
.affine-modal-title,
.affine-dialog-title,
[role="dialog"] h1,
[role="dialog"] h2,
[role="dialog"] h3 {
  color: #ffffff !important;
}

/* Modal inputs */
.affine-modal input,
.affine-modal textarea,
.affine-dialog input,
.affine-dialog textarea,
[role="dialog"] input,
[role="dialog"] textarea,
.affine-link-popover input {
  background-color: #303030 !important;
  border-color: #444 !important;
  color: #eaeaea !important;
}

.affine-modal input::placeholder,
.affine-dialog input::placeholder,
[role="dialog"] input::placeholder {
  color: #6b6b6b !important;
}

.affine-modal input:focus,
.affine-dialog input:focus,
[role="dialog"] input:focus {
  border-color: #1E96EB !important;
  outline: none !important;
}

/* Modal buttons */
.affine-modal button,
.affine-dialog button,
[role="dialog"] button {
  color: #eaeaea !important;
}

.affine-modal button:hover,
.affine-dialog button:hover,
[role="dialog"] button:hover {
  background-color: #3a3a3a !important;
}

/* Cancel/secondary buttons */
.affine-modal button[class*="cancel"],
.affine-modal button[class*="secondary"],
.affine-dialog button[class*="cancel"],
[role="dialog"] button:not([class*="primary"]):not([class*="confirm"]) {
  background-color: transparent !important;
  border-color: #444 !important;
}

/* Primary/confirm buttons */
.affine-modal button[class*="primary"],
.affine-modal button[class*="confirm"],
.affine-dialog button[class*="primary"],
.affine-dialog button[class*="confirm"],
[role="dialog"] button[class*="primary"],
[role="dialog"] button[class*="confirm"] {
  background-color: #1E96EB !important;
  color: #ffffff !important;
  border-color: #1E96EB !important;
}

/* Slash menu specific */
.affine-slash-menu,
.affine-slash-menu-container {
  background-color: #1e1e1e !important;
  border: 1px solid #2e2e2e !important;
  border-radius: 8px !important;
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.5) !important;
}

.affine-slash-menu-item,
.affine-menu-item {
  color: #eaeaea !important;
}

.affine-slash-menu-item:hover,
.affine-menu-item:hover,
.affine-slash-menu-item[data-selected="true"],
.affine-menu-item[aria-selected="true"] {
  background-color: #2a2a2a !important;
}

.affine-slash-menu-item-icon,
.affine-menu-item-icon {
  color: #a8a8a0 !important;
}

.affine-slash-menu-category,
.affine-menu-category {
  color: #6b6b6b !important;
}

/* Format toolbar */
.affine-format-bar,
.affine-format-bar-widget,
.affine-inline-toolbar {
  background-color: #1e1e1e !important;
  border: 1px solid #2e2e2e !important;
  border-radius: 8px !important;
}

.affine-format-bar button,
.affine-inline-toolbar button {
  color: #eaeaea !important;
}

.affine-format-bar button:hover,
.affine-inline-toolbar button:hover {
  background-color: #2a2a2a !important;
}

/* Tooltips */
[class*="tooltip"],
.affine-tooltip {
  background-color: #303030 !important;
  color: #eaeaea !important;
  border-color: #444 !important;
}

/* Dropdown menus */
[class*="dropdown"],
.affine-dropdown-menu,
.affine-select-menu {
  background-color: #1e1e1e !important;
  border-color: #2e2e2e !important;
}

[class*="dropdown"] li,
[class*="dropdown"] button,
.affine-dropdown-menu li,
.affine-dropdown-menu button {
  color: #eaeaea !important;
}

[class*="dropdown"] li:hover,
[class*="dropdown"] button:hover {
  background-color: #2a2a2a !important;
}